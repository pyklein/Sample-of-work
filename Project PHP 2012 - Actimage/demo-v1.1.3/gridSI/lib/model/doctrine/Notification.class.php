<?php

/**
 * Notification
 * 
 * This class has been auto-generated by the Doctrine ORM Framework
 * 
 * @package    gridSI
 * @subpackage model
 * @author     Jihad Sahebdin
 * @version    SVN: $Id: Builder.php 7691 2011-02-04 15:43:29Z jwage $
 */
class Notification extends BaseNotification
{
  public function __toString() {
    return $this->getExtrait($this->getContenu(), 5);
  }
  /*
   * Affiche l'état de la notification selon les trois cas:
   * 'en cours' , 'passée' ou 'à venir'
   */
  public function getValiditeLibelle()
  {
    if(($this->getDateDebut() <= date('Y-m-d H:i:s', time())) && ($this->getDateFin() >= date('Y-m-d', time())) )
    {
      return libelle("msg_libelle_en_cours");
    }
    else if($this->getDateFin() < date('Y-m-d', time()))
    {
      return libelle("msg_libelle_passee");
    }
    else if($this->getDateDebut() > date('Y-m-d', time()))
    {
      return libelle("msg_libelle_a_venir");
    }
  }

  /*
   * Affiche 'Actif' ou 'Inactif'
   */
  public function  getEstActifLibelle()
  {
    if($this->getEstActif() == 1)
    {
      return libelle("msg_libelle_actif");
    }
    else
    {
      return libelle("msg_libelle_inactif");
    }
  }

  /*
   * Affiche un extrait de la notification(strTexte) dans le cas
   * où sa longueur dépasse intLongueur caractères
   */
  public function getExtrait()
  {
    $intLongueur = sfConfig::get("app_extrait_longueur");
    $strConenu = strip_tags($this->getContenu());

    if($intLongueur > 0 && strlen($strConenu) > $intLongueur)
    {
      $strExtrait = substr($strConenu, 0, $intLongueur);
      $strExtrait = substr($strExtrait, 0, strrpos($strExtrait, " ")).'...';
      return $strExtrait;
    }
    else
    {
      return $strConenu;
    }
  }
}
