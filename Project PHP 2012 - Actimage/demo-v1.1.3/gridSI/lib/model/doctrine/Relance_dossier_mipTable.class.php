<?php

/**
 * Relance_dossier_mipTable
 * 
 * This class has been auto-generated by the Doctrine ORM Framework
 */
class Relance_dossier_mipTable extends Doctrine_Table
{
    /**
     * Returns an instance of this class.
     *
     * @return object Relance_dossier_mipTable
     */
    public static function getInstance()
    {
        return Doctrine_Core::getTable('Relance_dossier_mip');
    }


  /**
   * Creer un query permetant de trouver des relances par type de relance et dossier
   *
   * @param integer $intIdDossier Id du dossier MIP vis-à-vis la base de données
   * @param intger $intIdTypeRelanceMip Id du type de relance dossier MIP
   *                                        vis-à-vis la base de données
   * @return Doctrine_Query
   *
   * @author Simeon PETEV
   */
  public function buildQueryFindByDossierType($intIdDossier,$intIdTypeRelanceMip)
  {
    if (sfContext::hasInstance())
      sfContext::getInstance()->getLogger()->debug("{".__CLASS__."} [".__FUNCTION__."] /Ligne: ".__LINE__."/ DEBUT; ");

    $objQuery = $this->getInstance()->getQueryObject()
                                        ->where('dossier_mip_id = ?',$intIdDossier)
                                        ->where('type_relance_dossier_mip_id = ?',$intIdTypeRelanceMip)
    ;

    if (sfContext::hasInstance())
      sfContext::getInstance()->getLogger()->debug("{".__CLASS__."} [".__FUNCTION__."] /Ligne: ".__LINE__."/ FIN; ");

    return $objQuery;
  }

  /**
   * Verifie si le type de la relance pour ce utilisateur a été envoyé
   *
   * @param integer $intIdDossier Id du dossier MIP vis-à-vis la base de données
   * @param intger $intIdTypeRelanceMip Id du type de relance dossier MIP
   *                                        vis-à-vis la base de données
   * @return boolean
   *
   * @author Simeon PETEV
   */
  public function estRelanceEnvoye($intIdDossier,$intIdTypeRelanceMip)
  {
    return ($this->buildQueryFindByDossierType($intIdDossier, $intIdTypeRelanceMip)->count() > 0);
  }

  /**
   * Recupere un Relance_dossier_mip
   *
   * @param integer $intIdDossier Id du dossier MIP vis-à-vis la base de données
   * @param intger $intIdTypeRelanceMip Id du type de relance dossier MIP
   *                                        vis-à-vis la base de données
   * @return object Relance_dossier_mip
   *
   * @author Simeon PETEV
   */
  public function findOneByDossierType($intIdDossier,$intIdTypeRelanceMip)
  {
    return ($this->buildQueryFindByDossierType($intIdDossier, $intIdTypeRelanceMip)->fetchOne());
  }
}